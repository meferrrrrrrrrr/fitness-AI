<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Profile - Fitness AI</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="public/favicon-32x32.png">
    <link rel="apple-touch-icon" href="public/apple-touch-icon.png">
</head>
<body>
    <div class="header-logo">
        <img src="public/logo.png" alt="Fitness AI Logo" style="width: 200px; height: auto; display: block; margin: 0 auto;">
    </div>
    <h1>Your Profile</h1>
    <div class="form-container">
        <p>Welcome to your Fitness AI profile! This is a placeholder page.</p>
        <p>Here you will soon manage your fitness and nutrition goals.</p>
        <p id="userEmail">Loading email...</p>
        <a href="index.html">Back to Home</a>
    </div>
    <script>
        // Funcție pentru a încărca email-ul utilizatorului
        async function loadUserEmail() {
            try {
                const token = localStorage.getItem('authToken'); // Obținem token-ul din localStorage
                console.log('Token găsit în Local Storage:', token); // Depanare: Verificăm token-ul
                if (!token) {
                    document.getElementById('userEmail').textContent = 'Nu există token. Te rog să te loghezi.';
                    return;
                }

                // Folosim URL-ul complet pentru Vercel
                const apiUrl = `${window.location.origin}/api/auth/user`;
                console.log('Trimit cerere către:', apiUrl); // Depanare: Confirmăm URL-ul

                const response = await fetch(apiUrl, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}` // Adăugăm token-ul în header
                    }
                });
                console.log('Răspuns primit:', response.status, response.statusText); // Depanare: Vedem statusul

                const data = await response.json();
                const emailElement = document.getElementById('userEmail');
                if (response.ok) {
                    emailElement.textContent = `Email: ${data.email}`; // Afișăm email-ul
                } else {
                    emailElement.textContent = `Eroare: ${data.error || 'Eroare la încărcarea email-ului.'}`; // Afișăm eroarea
                }
            } catch (error) {
                console.error('Eroare detaliată la fetch:', error); // Depanare: Vedem eroarea completă
                document.getElementById('userEmail').textContent = `Eroare la conectare cu serverul: ${error.message}`;
            }
        }

        // Apelăm funcția când pagina se încarcă
        window.onload = loadUserEmail;
    </script>
</body>
</html>